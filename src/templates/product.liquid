{% section 'product-template' %}

<script src="{{ 'product.js' | asset_url }}" defer></script>
<script>
  // Override default values of shop.strings for each template.
  // Alternate product templates can change values of
  // add to cart button, sold out, and unavailable states here.
  theme.productStrings = {
    addToCart: {{ 'products.product.add_to_cart' | t | json }},
    soldOut: {{ 'products.product.sold_out' | t | json }},
    unavailable: {{ 'products.product.unavailable' | t | json }}
  };
</script>

<!--KLAVIYO TRACKING -->
<script text="text/javascript">
  var _learnq = _learnq || [];

  var klaviyoItem = window.klaviyoItem || {
    Name: {{ product.title|json }},
    ProductID: {{ product.id|json }},
    Categories: {{ product.collections|map:'title'|json }},
    ImageURL: "https:{{ product.featured_image.src|img_url:'grande' }}",
    URL: "{{ shop.secure_url }}{{ product.url }}",
    Brand: {{ product.vendor|json }},
    Price: {{ product.price|money|json }},
    CompareAtPrice: {{ product.compare_at_price_max|money|json }}
  };

  _learnq.push(['track', 'Viewed Product', klaviyoItem]);
  _learnq.push(['trackViewedItem', {
    Title: klaviyoItem.Name,
    ItemId: klaviyoItem.ProductID,
    Categories: klaviyoItem.Categories,
    ImageUrl: klaviyoItem.ImageURL,
    Url: klaviyoItem.URL,
    Metadata: {
      Brand: klaviyoItem.Brand,
      Price: klaviyoItem.Price,
      CompareAtPrice: klaviyoItem.CompareAtPrice
    }
  }]);
</script>
<script text="text/javascript">
	var _learnq = _learnq || [];
  window.dataLayer = window.dataLayer || [];
  jQuery(function ($) {
    $('body').on('click', 'button.add-to-cart', function () {
      _learnq.push(['track', 'Added to Cart', klaviyoItem]);
      window.dataLayer.push({'event': 'AddToCart', eventId: Math.random().toString(16).slice(2)});
    });
  });
</script>
<!--END KLAVIYO TRACKING -->
